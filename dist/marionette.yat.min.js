/**
* @license
* Marionette.Yat extension for Backbone.Marionette
* Yet Another Toolkit
* ----------------------------------
* v0.0.32
*
* Distributed under MIT license
* author: dimtabu
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("backbone"),require("backbone.marionette"),require("underscore"),require("jquery")):"function"==typeof define&&define.amd?define(["backbone","backbone.marionette","underscore","jquery"],e):t.MarionetteYat=e(t.Backbone,t.Marionette,t._,t.jQuery)}(this,function(t,e,i,n){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e,i=i&&i.hasOwnProperty("default")?i.default:i,n=n&&n.hasOwnProperty("default")?n.default:n;var r=function(i){return i instanceof t.Model?i:i instanceof e.View?i.model:void 0},o=function(e){return e instanceof t.View?e:void 0},s=function(t,e,i){return"function"==typeof i&&(t=i.call(t,r(t),o(t)),e=i.call(e,r(e),o(e))),t<e?-1:t>e?1:0},a={compareAB:s,viewComparator:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[],o=0;return e.length>=2?s.apply(null,e):(1===e.length&&e[0]instanceof Array&&(r=e[0]),i(r).every(function(t){return 0===(o=s.apply(null,t))}),o)}};function l(t,e,n){return i.isFunction(e)&&(e=e.apply(t,n||[])),e}function h(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==n.fields||n.fileds&&!n.fileds.length)throw new Error("fields option missing");if(n.checked||(n.checked={}),null!=e){var r=void 0,o=e instanceof t.Model,s=i.isObject(e.options),a=n.exclude instanceof Array?n.exclude:"string"==typeof n.exclude?[n.exclude]:[];return i(n.fields).some(function(t){if(!(t in n.checked||(n.checked[t]=!0,a.indexOf(t)>=0)))return o&&null==r&&(r=l(e,e.get(t),n.args)),null==r&&(r=l(e,e[t],n.args)),null==r&&s&&(r=l(e,e.options[t],n.args)),null!=r}),null==r?n.default:r}}function u(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:":";return t||(t=""),t+i+(e=null==e?"":e.toString())}function c(e,n){if(null!=e&&i.isObject(e)&&null!=n&&""!=n)return e instanceof t.Model?e.get(n):e[n]}function g(e,i,n,r){return e instanceof t.Model?e.set(i,n,{silent:!0}):e[i]=n,n instanceof t.Model&&r.models.push({path:r.passPath.join(":"),property:i,model:n}),r.passPath.push(i),c(e,i)}var d=function(e,n,r,o){if(null!=e&&i.isObject(e)&&null!=n&&""!=n){var s=i.extend({},o);if(s.silent=!0===s.silent,s.force=!1!==s.force,!i.isObject(n)||n instanceof Array||(r=n.value,s.force=!1!==n.force,s.silent=!0===n.silent,n=n.path),s.path=n,s.passPath=[],s.models=[],null!=n&&""!=n){var a="string"==typeof n?n.split("."):n instanceof Array?[].slice.call(n):[n];if(s.pathArray=[].slice.call(a),a.length){a.length;var l=a.shift();e instanceof t.Model&&s.models.push({path:"",property:l,model:e});var h=function t(e,n,r,o,s){if(null!=e&&i.isObject(e)&&null!=n&&""!=n){if(!r.length)return g(e,n,o,s);var a=c(e,n);if(i.isObject(a)||s.force)return!i.isObject(a)&&s.force&&(a=g(e,n,{},s)),t(a,r.shift(),r,o,s)}}(e,l,a,r,s);if(void 0===h&&void 0!==r)return h;if(!s.silent)for(var u=s.pathArray.join(":");s.models.length;){var d=s.models.pop(),f=""==d.path?u:u.substring(d.path.length+1);f&&d.model.trigger("change:"+f,r),d.model.trigger("change",d.model)}return h}}}};function f(t,e){if(null!=t&&i.isObject(t)&&null!=e&&""!=e){var n="string"==typeof e?e.split("."):e instanceof Array?[].slice.call(e):[e];return function t(e,n,r){if(null!=e&&i.isObject(e)&&null!=n&&""!=n){var o=c(e,n);return!r.length||r.length&&null==o?o:t(o,r.shift(),r)}}(t,n.shift(),n)}}var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function v(e){if(null!=e&&i.isObject(e)){var n={};return function e(i,n){if(n=n||"",null!=this&&"object"==p(this))for(var r=this instanceof t.Model?this.attributes:this,o=Object.getOwnPropertyNames(r),s=0;s<o.length;s++){var a=o[s],l=this[a];null==l||"object"!=(void 0===l?"undefined":p(l))||l instanceof Date||l instanceof Array?i[n+a]=l:"object"==(void 0===l?"undefined":p(l))&&e.call(l,i,n+a+".")}}.call(e,n),n}}function y(t){if(null!=t&&i.isObject(t)){var e={};for(var n in t)d(e,n,t[n],!0);return e}}function m(t,e){if(!i.isString(t))return t;var n=!0===e?/(^|:)(\w)/gi:/(:)(\w)/gi;return t.replace(n,function(t,e,i){return i.toUpperCase()})}var _={camelCase:m,getLabel:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.fields=["getLabel","label","getName","name","getValue","value"].concat(e.fields||[]),h(t,e)},getName:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.fields=["getName","name","getLabel","label","getValue","value"].concat(e.fields||[]),h(t,e)},getValue:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.fields=["getValue","value","getId","id","getName","name","getLabel","label","cid"].concat(e.fields||[]),h(t,e)},wrap:u,unwrap:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:":";if(null!=t){if(t=t.toString(),e||(e=""),!t.length)return t;var n=new RegExp("^"+e+i);return t.replace(n,"")}},setByPath:d,getByPath:f,flattenObject:v,unFlattenObject:y,isView:function(e){return e instanceof t.View}},b={view:a,common:_},w=[t.Model,t.Collection,t.View,t.Router,e.Object];function x(t){var e=i.isFunction(t),n=i(w).some(function(e){return t===e||t.prototype instanceof e});return e&&n}var C=e.Error.extend({},{Http400:function(t){return this.Http(400,t)},Http401:function(t){return this.Http(401,t)},Http403:function(t){return this.Http(403,t)},Http404:function(t){return this.Http(404,t)},Http500:function(t){return this.Http(500,t)},Http:function(t,e){var i=new this({message:e,name:"HttpError"});return i.status=t,i},HttpRedirect:function(t){return this.Http(301,t)},NotFound:function(t){return this.Http404(t)},NotAuthorized:function(t){return this.Http401(t)},Forbidden:function(t){return this.Http403(t)}});function O(t){var n=null;if(i.isFunction(t))n=t;else{if(!i.isObject(t)||null===t)throw new Error("argument should be an object or class definition");var r=function(){};r.extend=e.extend,n=r.extend(t)}n.extend||((n=e.extend.call(t,{})).extend=e.extend);return{with:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.reduce(e,function(t,e){return function(t,e){if(i.isFunction(e))return e(t);if(i.isObject(e))return t.extend(e);throw new C("Mixin fail, argument should be an object hash or mixin function")}(t,e)},n)},class:n}}var P=function(t){return t.extend({getProperty:function(t,e){return this._getOptionOrProperty(this,t,e,this.getOption)},getOption:function(t,e){return this._getOptionOrProperty(this.getProperty("options",{deep:!1}),t,e,this.getProperty)},_getOptionOrProperty:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3];if(void 0!==n.deep||(n.deep=!0),void 0!==n.force||(n.force=!0),n.args||(n.args=[]),null!=e){var o=t&&t[e];if(void 0===o&&n.deep&&i.isFunction(r)){var s=i.extend({},n,{deep:!1,force:!1});o=r.call(this,e,s)}return i.isFunction(o)&&n.force&&!x(o)&&(o=o.apply(this,n.args||[])),void 0===o?n.default:o}}})},S=function(t){return t.extend({constructor:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];t.apply(this,i);var r=!(!0===this.getProperty("initRadioOnInitialize"));this._initRadio({skip:r})},getChannel:function(){return this._channel||this._initRadio({skip:!1}),this._channel},_initRadio:function(){if(1!=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{skip:!0}).skip){if(!this.getProperty("channelName")){var t=this.getProperty("channel");t&&(this.channelName=t.channelName)}e.Object.prototype._initRadio.call(this)}},radioRequest:function(){var t=this.getChannel();t&&t.request.apply(t,arguments)},radioTrigger:function(){var t=this.getChannel();t&&t.trigger.apply(t,arguments)}})},k=O(e.Object).with(P,S),M={scrollable:{get:function(t){var e={};return t.$("[data-scrollable]").each(function(t,i){var r=n(i),o=r.data("scrollable");e[o]={top:r.scrollTop(),left:r.scrollLeft()}}),e},set:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.$("[data-scrollable]").each(function(t,i){var r=n(i),o=r.data("scrollable"),s=e[o];isNaN(s.top)||r.scrollTop(s.top),isNaN(s.left)||r.scrollLeft(s.left)})}}},R={},A=k.extend({initialize:function(t){this._initStates()},_initStates:function(){var t=this;this._states={};var e=this.getOption("states");i(e).each(function(e,i){"string"==typeof e&&(i=e,e=M[e]),t._isStateEntry(e)&&(t._states[i]=e)})},_isStateEntry:function(t){return i.isObject(t)&&i.isFunction(t.get)&&i.isFunction(t.set)},apply:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getStore(t,e);i(this._states).each(function(i,r){i.set(t,n[r],e)})},collect:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getStore(t,e);i(this._states).each(function(i,r){n[r]=i.get(t,e)})},getStore:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getStoreKey(t,e);return R[i]||(R[i]={}),R[i]},getStoreKey:function(t){var e=this.getOption("storeIdPrefix");return(e?e+":":"")+String(t.id||t.cid)}});A.set=function(t,e){M[t]=e},A.remove=function(t){delete M[t]},A.clear=function(){var t=i(M).keys();i(t).each(function(t){return delete M[t]})},A.states=function(){return M},A.store=function(){return R};var D={isKnownCtor:x,mix:O,ViewStateApi:A};function E(t){return t.extend({getName:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=i.extend({},t);return e.exclude="getName",e.args=[e],_.getName(this,e)},getLabel:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=i.extend({},t);return e.exclude="getLabel",e.args=[e],_.getLabel(this,e)},getValue:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=i.extend({},t);return e.exclude="getValue",e.args=[e],_.getValue(this,e)}})}var j=function(t){var e=t.extend({verboseStateBoolean:!1,verboseStateString:!1,verboseStateHash:!1,verboseState:!1,constructor:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];t.apply(this,i),this.initializeStateable()},initializeStateable:function(){this._state={}},getState:function(t){var e=this._state;return t?e[t]:e},setState:function(t,e,n){if(null!=t)if(i.isObject(t)){var r=this;n=e,e=t;var o=i.extend({},n,{doNotTriggerStateHash:!0});i(e).each(function(t,e){return r.setState(e,t,o)}),this._tryTriggerStateChange(e,n)}else{this.getState()[t]=e,this._tryTriggerStateChange(t,e,n)}},clearState:function(){var t=this.getState(),e=i.extend({},t);i(t).each(function(i,n){e[n]=void 0,delete t[n]}),this._tryTriggerStateChange(e)},_tryTriggerStateChange:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!0!==n.silent){if(i.isObject(t))n=e,e=t,this._triggerStateChange("verboseStateHash","state",e,n);else{this._triggerStateChange("verboseState","state:"+t,e,this,n);var r=String(e).toLowerCase().trim();["true","false"].indexOf(r)>=0&&this._triggerStateChange("verboseStateBoolean","state:"+t+":"+r,this,n),i.isString(e)&&this._triggerStateChange("verboseStateString","state:"+t+":"+e,this,n),n.doNotTriggerStateHash||this._triggerStateChange("verboseStateHash","state",(o={},s=t,a=e,s in o?Object.defineProperty(o,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[s]=a,o),this,n)}var o,s,a}},_triggerStateChange:function(t){var e=i.isFunction(this.triggerMethod)?this.triggerMethod:i.isFunction(this.trigger)?this.trigger:null,n=!0===this.getProperty(t);if(e&&n){for(var r=arguments.length,o=Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];e.apply(this,o)}}});return e.Stateable=!0,e};function T(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}var V="initialized",z="starting",H="running",F="stopping",B="waiting",L="destroyed";var N={set:function(t){this.setState("life",t)},get:function(){return this.getState("life")},is:function(t){return this._lifestate.get()===t},isIn:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return i(n).some(function(e){return t._lifestate.is(e)})},isInProcess:function(){return this._lifestate.isIn(z,F)},isIdle:function(){return this._lifestate.isIn(V,H,B)}},G={setHelperListeners:function(){var t=this,e=!0===this.getProperty("freezeWhileStarting"),n=!0===this.getProperty("freezeWhileStopping");i.isFunction(this.freezeUI)&&(e&&this.on("before:start",this.freezeUI),n&&this.on("before:stop",this.freezeUI)),i.isFunction(this.unFreezeUI)&&(e&&this.on("start start:decline",this.unFreezeUI),n&&this.on("stop stop:decline",this.unFreezeUI)),this.on("destroy",function(){return t._lifestate.set(L)})},isIntact:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{throwError:!1},e=new C({name:"StartableLifecycleError",message:"Startable has already been destroyed and cannot be used."}),i=this._lifestate.is(L);if(t.throwError&&i)throw e;if(i)return e},isIdle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{throwError:!1},e=this._startable.isIntact(t),i="Startable is not idle. current state: "+this._lifestate.get(),n=new C({name:"StartableLifecycleError",message:i}),r=this._lifestate.isInProcess();if(t.throwError&&r)throw n;return e||(r?n:void 0)},canNotStart:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{throwError:!1},e=new C({name:"StartableLifecycleError",message:"Startable has already been started."}),i=this._startable.isIdle(t),n=!0===this.getProperty("allowStartWithoutStop");if(i||!n){var r=this._lifestate.is(H);if(t.throwError&&r)throw e;return i||(r?e:void 0)}},canNotStop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{throwError:!1},e=new C({name:"StartableLifecycleError",message:"Startable should be in `running` state."}),i=this._startable.isIdle(t),n=!0===this.getProperty("allowStopWithoutStart");if(i||!n){var r=this._lifestate.is(H);if(t.throwError&&!r)throw e;return i||(r?void 0:e)}},addRuntimePromise:function(t,e){if(null!=e){var i="_"+t+"RuntimePromises";this[i]||(this[i]=[]),this[i].push(e)}}},$={freezeWhileStarting:!1,freezeWhileStopping:!1,freezeUI:function(){},unFreezeUI:function(){},preventStart:function(){},preventStop:function(){},triggerStartBegin:function(){},triggerBeforeStart:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.triggerMethod.apply(this,["before:start"].concat(e))},triggerStart:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.triggerMethod.apply(this,["start"].concat(e))},triggerStartDecline:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.triggerMethod.apply(this,["start:decline"].concat(e))},triggerStopBegin:function(){},triggerBeforeStop:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.triggerMethod.apply(this,["before:stop"].concat(e))},triggerStop:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.triggerMethod.apply(this,["stop"].concat(e))},triggerStopDecline:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.triggerMethod.apply(this,["stop:decline"].concat(e))}},I={process:function(t){var e=this;if(null==t||!i.isObject(t)||!i.isObject(t.startable))throw new Error("process context missing or incorrect");this.clearRuntimePromises(t);return new Promise(function(i,n){if(t.reject=n,t.resolve=i,e.triggerBegin(t),!e.canNotBeDone(t)&&!e.isNotAllowed(t)){e.triggerBefore(t),e.updateState(t);return e.prepare(t).then(function(){return e.success(t)},function(i){return e.fail(i,t)})}})},triggerBegin:function(t){this._executeOnStartable(t.startable,"trigger:"+t.process+":begin",t.args)},canNotBeDone:function(t){var e=t.startable._startable,i=this._executeOnStartable(e,"can:not:"+t.process);if(i)return t.reject(i),i},isNotAllowed:function(t){var e=t.startable,i=this._executeOnStartable(e,"prevent:"+t.process,t.args);if(i)return t.reject(i),i},triggerBefore:function(t){this._executeOnStartable(t.startable,"trigger:before:"+t.process,t.args)},updateState:function(t){var e=t.startable;t.stateRollback=e._lifestate.get(),e._lifestate.set(t.stateProcess)},success:function(t){t.startable._lifestate.set(t.stateEnd),t.resolve.apply(t,T(t.args||[])),this._executeOnStartable(t.startable,"trigger:"+t.process,t.args)},fail:function(t,e){e.startable._lifestate.set(e.stateRollback);var i=this._executeOnStartable(e.startable,"trigger:"+e.process+":decline",e.args);return e.reject(i||t)},prepare:function(t){if(t.startable){var e=[this.parentPromise(t),this.instancePromise(t),this.runtimePromise(t)],n=i(e).filter(function(t){return null!=t});return t.skipRuntimePromises?n.length?Promise.all(n):void 0:Promise.all(n)}},parentPromise:function(t){var e=t.startable,n=i.result(e,"getParent");if(n){var r={startable:n,process:t.process,skipRuntimePromises:!0};return this.prepare(r)}},instancePromise:function(t){return this._propertyPromise(t.startable,t.process+"Promises")},runtimePromise:function(t){if(!t.skipRuntimePromises){return this._propertyPromise(t.startable,"_"+t.process+"RuntimePromises","getProperty")}},clearRuntimePromises:function(t){t.startable["_"+t.process+"RuntimePromises"]=[]},_propertyPromise:function(t,e){var n=function(t,e){if(null==t)return[];if(i.isArray(t)){var n=i(t).map(function(t){return i.isFunction(t)?t.call(e,t):i.isObject(t)?t:void 0});return i(n).filter(function(t){return null!=t})}return i.isObject(t)?[t]:void 0}(t[arguments.length>2&&void 0!==arguments[2]?arguments[2]:"getOption"](e),t);return n.length?Promise.all(n):void 0},_executeOnStartable:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=m(e);return i.isFunction(t[r])&&t[r].apply(t,T(n))}};function U(t,e){e||(e=t),i(t).each(function(n,r){i.isFunction(n,r)&&(t[r]=i.bind(n,e))})}var Y=function(t){var e=O(t).with(j,$),n=e.extend({constructor:function(){this._startPromises=[],this._stopPromises=[],this._initializeStartable();for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.apply(this,i),this._lifestate.set(V)},start:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];var n={startable:this,process:"start",stateProcess:z,stateEnd:H,args:e};return I.process(n)},stop:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];var n={startable:this,process:"stop",stateProcess:F,stateEnd:B,args:e};return I.process(n)},restart:function(){for(var t=this,e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];return this.isStarted()?this.stop().then(function(){return t.start.apply(t,i)}):this.start.apply(this,i)},isStarted:function(){return this._lifestate.is(H)},isStoped:function(){return this._lifestate.in(B,V)},isInProcess:function(){return this._lifestate.isInProcess()},addStartPromise:function(t){this._startable.addRuntimePromise("start",t)},addStopPromise:function(t){this._startable.addRuntimePromise("stop",t)},_initializeStartable:function(){this._lifestate=i.extend({},N),this._startable=i.extend({},G),U(this._lifestate,this),U(this._startable,this),this._startable.setHelperListeners()}});return n.Startable=!0,n},W=function(t){var e="_children",n=t.extend({constructor:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];t.apply(this,i),this.initializeChildrenable.apply(this,i)},initializeChildrenable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._initializeParrent(t),this._initializeChildren(t)},hasChildren:function(){this.getChildren();return this[e].length>0},getChildren:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{startable:!0},i=this[e]||[];return t.startable?i.filter(function(t){return!t.getProperty("preventStart")}):i},hasParent:function(){var t=this.getParent();return i.isObject(t)},getParent:function(){return this.getProperty("parent",{deep:!1})},_initializeChildren:function(){var t=this,n=this.getProperty("children"),r=[];i(n).each(function(e){var i=t._normalizeChildContext(e),n=t._initializeChild(i);n&&r.push(n)}),this[e]=r},_initializeChild:function(t){if(null!=t&&i.isFunction(t.Child)){var e=t.Child,n=this._normalizeChildOptions(t);return this.buildChild(e,n)}},_normalizeChildContext:function(t){var e={};return i.isFunction(t)&&t.Childrenable?i.extend(e,{Child:t}):i.isFunction(t)?e=this._normalizeChildContext(t.call(this)):i.isObject(t)&&(e=t),e},_normalizeChildOptions:function(t){var e=i.extend({},t);return!0===this.getOption("passToChildren")&&i.extend(e,this.options),e.parent=this,delete e.Child,this._buildChildOptions(e)},_buildChildOptions:function(t){return i.extend(t,this.getProperty("childOptions"))},buildChild:function(t,e){return new t(e)},_initializeParrent:function(t){null==this.parent&&null!=t.parent&&(this.parent=t.parent)}});return n.Childrenable=!0,n},X=[function(t){return{_v:t,_m:t.model||{},_cid:function(e){return u(t.cid,e)}}}],q={},K=!1;var Q={mix:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=this.get.apply(this,n);return i.extend(o,t)},get:function(){return this.compile.apply(this,arguments)},add:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];i(n).each(function(e){return t.push(e)})},compile:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];K&&(q={});var r={};return i(X).each(function(t){i.isFunction(t)?i.extend(r,function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return i.isFunction(t)?t.apply(void 0,n):i.isObject(t)?t:{}}.apply(void 0,[t].concat(e))):K&&i.extend(q,t)}),K||i.extend(r,q),K=!1,r},pop:function(){return K=!0,X.pop()},shift:function(){return K=!0,X.shift()},push:function(t){K=!0,X.push(t)},unshift:function(t){K=!0,X.unshift(t)},clear:function(){K=!1,q={},X=[]}},J=function(t){return t.extend({mixinTemplateContext:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Q.mix(i.result(this,"templateContext"),this);return i.extend(t,e)}})},Z={GetNameLabel:E,GetOptionProperty:P,Radioable:S,Stateable:j,Startable:Y,Childrenable:W,GlobalTemplateContext:J},tt=O(e.Behavior).with(P),et=tt.extend({listenViewInitialize:!0,constructor:function(){!0===this.getProperty("listenViewInitialize")&&this.on("before:render initialize",i.once(i.partial(this.triggerMethod,"view:initialize"))),tt.apply(this,arguments)},getModel:function(){return this.view.model},cidle:function(t){return _.wrap(this.view.cid,t)},unCidle:function(t){return _.unwrap(t,this.view.cid)}}),it=et.extend({triggerEl:void 0,moveBeforeStart:10,scope:"drag",getDragEventsContext:function(){return this.$doc},getDragEventsElementSelector:function(){return"*"},getTriggerEl:function(){if(this._$el)return this._$el;var t=this.getOption("triggerEl");if(null==t&&this.view.$el)this._$el=this.view.$el;else if(t&&t.jquery)this._$el=t;else if(t instanceof HTMLElement)this._$el=n(t);else{if("string"!=typeof t||!t.length)throw new Error("trigger element should be a DOM or jQuery object or string selector.",t);this._$el=this.view.$(t)}return this._$el},isSameScope:function(t){return t.scope===this.scope},shouldHandleDomEvents:function(t){return this.isSameScope(t)&&this!==t},constructor:function(){this._clearDragData(),this.$doc=n(document);for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];et.apply(this,e),this._defineDocumentBindings()},_clearDragData:function(){this._dragData={}},_defineDocumentBindings:function(){this.__b={},this.__b.setupDragDetection=i.bind(this._setupDragDetection,this),this.__b.handleMouseUp=i.bind(this._handleMouseUp,this),this.__b.handleMoveAfterMouseDown=i.bind(this._handleMoveAfterMouseDown,this),this.__b.handleDragMove=i.bind(this._handleDragMove,this),this.__b.handleElementEnter=i.bind(this._handleElementEnter,this),this.__b.handleElementLeave=i.bind(this._handleElementLeave,this),this.__b.handleElementOver=i.bind(this._handleElementOver,this)},onInitialize:function(){this._initializeDragListener()},_initializeDragListener:function(){this.getTriggerEl().one("mousedown",this.__b.setupDragDetection)},_setupDragDetection:function(t){!0!==this.view.dragDisabled?(t.stopPropagation(),this.$doc.one("mouseup",this.__b.handleMouseUp),this._dragData.startX=t.pageX,this._dragData.startY=t.pageY,this.$doc.on("mousemove",this.__b.handleMoveAfterMouseDown)):this._initializeDragListener()},_handleMouseUp:function(t){this._dragData.dragging?this._handleDragEnd(t):this._handleEndWithoutDrag(t),this._initializeDragListener()},_handleEndWithoutDrag:function(t){this.$doc.off("mousemove",this.__b.handleMoveAfterMouseDown)},_handleDragEnd:function(t){this._dragData.dragging=!1,this.$doc.off("mousemove",this.__b.handleDragMove);var e=this.getDragEventsContext();e.off("mouseenter",this.__b.handleElementEnter),e.off("mousemove",this.__b.handleElementOver),this._dragData.drop&&this._dragData.drop.context&&(this._dragData.drop.context.catchDraggable(this,this._dragData.drop),this.triggerMethod("drag:drop",this._dragData.drop)),this.triggerMethod("drag:end")},_handleMoveAfterMouseDown:function(t){t.stopPropagation();this._getStartPositionPixelOffset(t)>=this.getOption("moveBeforeStart")&&this._startDragSession()},_getStartPositionPixelOffset:function(t){var e=Math.abs(t.pageX-this._dragData.startX),i=Math.abs(t.pageY-this._dragData.startY);return e>i?e:i},_startDragSession:function(){this._dragData.dragging=!0,this.$doc.off("mousemove",this.__b.handleMoveAfterMouseDown),this.$doc.on("mousemove",this.__b.handleDragMove);var t=this.getDragEventsContext(),e=this.getDragEventsElementSelector();t.on("mouseenter",e,this.__b.handleElementEnter),t.on("mousemove",e,this.__b.handleElementOver),this.view.triggerMethod("drag:start")},_handleDragMove:function(t){t.stopPropagation(),this.triggerMethod("drag",t)},_handleElementEnter:function(t){var e=this,i=n(t.target);this._dragData.over!=i&&(this._dragData.over=i,i.trigger("drag:enter",this),i.one("mouseleave",function(){return e.trigger("drag:leave",e)}))},_handleElementLeave:function(t){n(t.target).trigger("drag:leave",this)},_handleElementOver:function(t){var e=n(t.target),i=this._createCustomDomEvent("drag:over",t);e.trigger(i,this)},_createCustomDomEvent:function(t,e,n){n||(n=["pageX","pageY","clientX","clientY","offsetX","offsetY","target"]);var r=jQuery.Event(t);return i(n).each(function(t){return r[t]=e[t]}),r}}),nt=it.extend({useGhost:!0,viewCssClass:"dragging",ghostCssClass:"ghost",constructor:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];it.apply(this,e),this.on("drag",this._onDrag),this.on("drag:start",this._onDragStart),this.on("drag:end",this._onDragEnd)},events:{"drag:enter":function(t,e){this.shouldHandleDomEvents(e)},"drag:over":function(t,e){if(this.isSameScope(e)){t.stopPropagation();var i=this._createCustomDomEvent("drag:over",t),n=this.$el.parent();n&&n.trigger(i,[e,this])}}},_onDragEnd:function(t){this.getOption("useGhost")&&this._removeGhost(),this.getOption("viewCssClass")&&this.view.$el.removeClass(this.getOption("viewCssClass")),this._clearDragData()},_onDragStart:function(t){this.getOption("useGhost")&&this._createGhost(),this.getOption("viewCssClass")&&this.view.$el.addClass(this.getOption("viewCssClass"))},_onDrag:function(t){this.setGhostPosition(t.pageY,t.pageX)},_removeGhost:function(){this.$ghost.remove(),delete this.$ghost},createGhost:function(){var t=this.$el.clone(),e=this.$el.offset(),i=e.top,n=e.left;return t.css({top:i+"px",left:n+"px",width:this.$el.outerWidth(),height:this.$el.outerHeight()}),t},_createGhost:function(){var t=this.createGhost();"absolute"!=t.css("position")&&t.css("position","absolute");var e=this.getOption("ghostCssClass");e&&t.addClass(e),t.appendTo(n("body")),this._setGhost(t)},_setGhost:function(t){this.$ghost=t},getGhost:function(){return this.$ghost},setGhostPosition:function(t,e){var i=this.getGhost();i&&i.css({top:t+"px",left:e+"px"})}}),rt=et.extend({scope:"drag",events:{"drag:over":"_onDomDragOver"},_skipFirstAttach:!0,isSameScope:function(t){return t.scope===this.scope},getEventXY:function(t){return{x:t.pageX,y:t.pageY}},getChildren:function(){return i(this.view.children._views).filter(function(t){return t.model&&t.isRendered()&&t.isAttached()})},catchDraggable:function(t,e){this._onDrop(t,e)},constructor:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];et.apply(this,e),this._initReorderBehavior()},_initReorderBehavior:function(){var t=this;this.listenToOnce(this.view,"render",function(){t.reOrder({silent:!0}),t.listenTo(t.view.collection,"update",function(t,e){(e||{}).changes;this.reOrder()})})},reOrder:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.view.sort();var e=this.children=[],n=this._skipFirstAttach;i(this.view.children._views).each(function(t,i){t.model&&(t.model.set("order",i),t.isRendered()&&(n||t.isAttached())&&e.push(t))}),this.hasChildren=this.children.length>0,1!=t.silent&&this.view.collection&&this.view.collection.trigger("reordered"),this._skipFirstAttach=!1},_onDomDragOver:function(t,e,n){if(this.isSameScope(e)&&(t.stopPropagation(),e!==n&&(!this.hasChildren||n))){e._dragData.drop||(e._dragData.drop={});var r=e._dragData.drop,o=this.getEventXY(t),s=this._getDropContext(o,n);s.context=this;var a=i.extend({},r,s),l=i.keys(a);i(l).some(function(t){return r[t]!==s[t]})&&(e._dragData.drop=s,this._onDropContextChange(e,s))}},_getDropContext:function(t,e){if(!(this.children||[]).length)return{insert:"before"};var i=e?e.$el:this.$el,n=this._getPositionByEventXY(t,i);return this._getDropContextByPosisiton(n,e)},_getPositionByEventXY:function(t,e){var i=e.offset(),n=e.outerWidth(),r=e.outerHeight(),o=i.left+n/2,s=i.top+r/2,a={x:void 0,y:void 0};return a.x=t.x<=o?"left":"right",a.y=t.y<=s?"top":"bottom",a},_getDropContextByPosisiton:function(t,e){var n="horizontal"==(this.getOption("direction")||"vertical")?"left"==t.x?"before":"after":"top"==t.y?"before":"after",r=void 0;return{insert:n,childView:r=e?e.view:"before"==n?this.children[0]:this.children.length&&i(this.children).last(),index:this.view.children._views.indexOf(r),noChild:!e}},_onDropContextChange:function(t,e){this.triggerMethod("drop:context:change",t,e)},_onDrop:function(t,e){this.triggerMethod("drop",t,e)}}),ot=et.extend({updateElementClass:function(t){var e=i.result(this.view,"className")||"",n=i.result(this.view,"dynamicClassName")||"";this.$el.attr({class:(e+" "+n).trim()})},refreshOnModelChange:!0,refreshOnDomChange:!1,refreshOnViewRefresh:!0,refreshOnViewBeforeRender:!0,refreshOnViewRender:!1,modelEvents:{change:function(){this.getProperty("refreshOnModelChange")&&this.updateElementClass("model:change")}},events:{change:function(){this.getProperty("refreshOnDomChange")&&this.updateElementClass("dom:change")}},onRefresh:function(){this.getProperty("refreshOnViewRefresh")&&this.updateElementClass("view:refresh")},onRender:function(){this.getProperty("refreshOnViewRender")&&this.updateElementClass("view:render")},onBeforeRender:function(){this.getProperty("refreshOnViewBeforeRender")&&this.updateElementClass("view:before:render")},onRefreshCssClass:function(){this.updateElementClass()},onSetupRefreshCssClass:function(t){var e=this;null!=t&&i.isObject(t)&&i(t).each(function(t,i){e[i]=!0===t})}});function st(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var at=O(et).with(j).extend({applyDelay:1,autoApplyToModel:!1,autoChangeModel:!1,fillFormFromModel:!0,applySelector:".apply",cancelSelector:".cancel",resetSelector:".reset",initialize:function(t){this.applyValue=i.debounce(this._applyValue,this.getProperty("applyDelay")),this.mergeOptions(t,["values"]),this.extendDefaultValues({})},extendDefaultValues:function(t){this._values=i.extend(this._values||{},t)},onViewInitialize:function(){var t=this.getModel();t&&this.extendDefaultValues(t.toJSON())},onRender:function(){this.firstRender||(this.buildFormBindings(),this.setState(this._tryFlatValues(this._values)),this.setValuesToForm(this.getValues({raw:!0}))),this.firstRender=!0},triggers:function(){var t;return st(t={},"click "+this.getProperty("applySelector"),"trigger:apply"),st(t,"click "+this.getProperty("cancelSelector"),"trigger:cancel"),st(t,"click "+this.getProperty("resetSelector"),"trigger:reset"),t},_tryFlatValues:function(t){return v(t)},_tryUnFlatValues:function(t){return y(t)},rollbackToDefaultValues:function(){this.clearState();var t=this._values,e=this._tryFlatValues(t);this.setState(e)},getValues:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getState();if(t.raw)return e;return this._tryUnFlatValues(e)},onTriggerApply:function(){this._apply()},onTriggerCancel:function(){this._cancel()},onTriggerReset:function(){this._reset()},_apply:function(){var t=this.getValues();this.view.triggerMethod("values:apply",t),this._tryChangeModel(t)},_cancel:function(){this.rollbackToDefaultValues();var t=this._getFullHash(this._values);this.view.triggerMethod("values:cancel",t),this.setValuesToForm(t),this._tryChangeModel(t,{clear:!0})},_reset:function(){this.clearState();var t=this._getFullHash({});this.view.triggerMethod("values:reset",t),this.setValuesToForm(t),this._tryChangeModel(t,{clear:!0})},onState:function(t){this._tryChangeModel(t,{type:"property"})},_tryChangeModel:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i="property"===e.type?"autoChangeModel":"autoApplyToModel";if(!0===this.getProperty(i)){var n=this.getModel();n&&(t=this._tryUnFlatValues(t),!0===e.clear&&n.clear(),n.set(t))}},_getFullHash:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getModel()&&this.getModel().toJSON(),n=i.extend({},this.values,this.mappings,e),r={};return i(n).each(function(t,e){return r[e]=void 0}),i.extend(r,t)},buildFormBindings:function(){var t=this;this.mappings={};var e=["input","textarea","select"];this.$("[name]").each(function(i,n){if(-1!=e.indexOf(n.tagName.toLowerCase())){var r=t.unCidle(n.name);if(!(r in t.mappings)){var o=t._getElementInfo(n,e);o&&(t.mappings[r]=o)}}});var n={};i(this.mappings).each(function(t,e){t.values&&(n[e]=t.values)}),this.extendDefaultValues(n)},_getElementInfo:function(t,e){var i={name:t.name},r=void 0,o='[name="'+t.name+'"]',s=this.$(o);if(s.length){if(s.length>1){var a=[],l=!1;s.each(function(t,i){if(-1!=e.indexOf(i.tagName.toLowerCase())){var r=n(i);if("checkbox"!=i.type&&"radio"!=i.type||r.prop("checked")){var o=r.val();l||(l="checkbox"===i.type||o instanceof Array),o instanceof Array?a=a.concat(o):a.push(r.val())}}}),r=!a.length||1===a.length&&!l?a[0]:a}else r="checkbox"===s.get(0).type?s.prop("checked")?[s.val()]:[]:s.val();return i.values=r,i.isArray=r instanceof Array,i.$elements=s,i}},setValuesToForm:function(t){var e=this;i(t).each(function(t,i){var n=e.mappings[i].$elements,r=t instanceof Array?t:[t];n.each(function(t,i){e._setValueToElement(i,t,r)})})},_setValueToElement:function(t,e,i){var r=e<i.length&&i[e],o=t.jquery?t:n(t);"checkbox"===(t=o.get(0)).type||"radio"===t.type?o.prop("checked",i.indexOf(o.val())>=0):o.val(r)},events:{change:"domChange",input:"domInput"},domChange:function(t){this.applyValue(t.target.name,t.target,t)},domInput:function(t){this.applyValue(t.target.name,t.target,t)},_applyValue:function(t,e,i){"checkbox"==e.type?this._applyCheckboxValue(t,e,i):this._applySimpleValue(t,e,i)},_applySimpleValue:function(t,e,i){t=this.unCidle(t);var r=n(e);this.setState(t,r.val())},_applyCheckboxValue:function(t,e,i){var n='input[type=checkbox][name="'+t+'"]:checked',r=this.$(n).map(function(t,e){return e.value}).toArray();t=this.unCidle(t),this.setState(t,r)}}),lt={Behavior:et,Draggable:nt,Droppable:rt,DynamicClass:ot,FormToHash:at},ht=(O(k).with(j),{tokenUrl:"",nativeAjax:n.ajax,ajax:function(){for(var t=this,e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return this.ensureToken().then(function(){var e=r[0];return e.headers=i.extend({},e.headers,t.getAjaxHeaders()),t.nativeAjax.apply(n,r)}).catch(function(t){var e=n.Deferred();return e.reject(t),e})},tokenXhr:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return this.nativeAjax({url:t,data:e,method:i})},ensureToken:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isRefreshNecessary(t))return Promise.resolve();var e=this.getOption("refreshTokenUrl"),i=this.getRefreshTokenData();return this.requestToken(i,e,{refresh:!0})},requestToken:function(t,e){var i=this;if(e||(e=this.getOption("tokenUrl")),!e)return Promise.reject("token url not specified");return new Promise(function(n,r){i.tokenXhr(e,t).then(function(t){i.setToken(t),n(t)},function(t){[400,401].indexOf(t.status)>-1?(i.authenticated=!1,i.triggerMethod("token:expired"),r(C.Http(t.status))):r(t)})})},getAjaxHeaders:function(){return this._ajaxHeaders||(this._ajaxHeaders={}),i.extend({},this._ajaxHeaders,this.getOption("ajaxHeader"))},replaceBackboneAjax:function(){var e=this,i=this.getTokenValue();t.ajax=i?function(){return e.ajax.apply(e,arguments)}:n.ajax},updateAjaxHeaders:function(){this._ajaxHeaders||(this._ajaxHeaders={});var t=this.getTokenValue(),e=this._ajaxHeaders;t?(e.Authorization="Bearer "+t,e.Accept="application/json"):delete e.Authorization}}),ut={tokenExpireOffset:void 0,getToken:function(){return this.token},getTokenValue:function(){var t=this.getToken();return t&&t.access_token},getRefreshTokenData:function(){return{grant_type:"refresh_token",refresh_token:(this.getToken()||{}).refresh_token}},getTokenExpires:function(){return(this.getToken()||{}).expires},getTokenSeconds:function(){var t=this.getTokenExpires();if(null==t||isNaN(t.valueOf()))return console.warn("expires is null or wrong"),0;var e=this.getProperty("tokenExpireOffset");null==e&&(e=3e4);var i=t.valueOf()-e-Date.now();return i>0?i/1e3:0},isRefreshNecessary:function(t){if(!0===t.force)return!0;return!!this.getTokenValue()&&!this.getTokenSeconds()},setToken:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.token=this.parseToken(t,e),this.beforeTokenChange(e),this.triggerMethod("before:token:change",this.token,e),!0!==e.silent&&this.triggerMethod("token:change",this.token),this.afterTokenChange(e),!1!==e.identity&&this.syncUser(e)},parseToken:function(t){return null==t?t:(null!=t&&i.isObject(t)&&(t.expires=new Date(Date.now()+1e3*t.expires_in)),t)},beforeTokenChange:function(t){this.updateAjaxHeaders(),this.replaceBackboneAjax()},afterTokenChange:function(){}},ct=new(O(k).with({authenticated:!1,isAuth:function(){return!0===this.authenticated},isAnonym:function(){return!this.isAuth()},isMe:function(t){return t&&this.isAuth()&&this.me==t},setMe:function(t){this.me=t}},ht,ut,{syncUser:function(t){var e=this,i=this.getUser();i?i.fetch().then(function(){e.applyUser(i)},function(){e.syncUserEror()}):this.triggerChange()},syncUserEror:function(){this.reset()},applyUser:function(t){var e=null==t?null:t.id;this.setMe(e),this.authenticated=null!=e,this.triggerChange()},getUser:function(){return this.user},setUser:function(t){this.user=t,this.applyUser(t)},isUser:function(){return this.isAuth()&&this.user&&!!this.user.id}}).extend({triggerChange:function(){this.triggerMethod("change")},reset:function(){this.authorized=!1;var t=this.getUser();t.clear(),this.setToken(null,{identity:!1}),this.applyUser(t),this.triggerMethod("reset")}})),gt=e.Region.extend({constructor:function(t){e.Region.apply(this,arguments),this.mergeOptions(t,["stateApi"]),this.stateApi&&this._initStateApi()},_initStateApi:function(){this.off("show",this._onStatableShow),this.off("before:empty",this._onStatableBeforeEmpty),this.on("show",this._onStatableShow),this.on("before:empty",this._onStatableBeforeEmpty)},_onStatableShow:function(t,e){var n=this.stateApi&&i.isFunction(this.stateApi.apply)?this.stateApi:void 0;n&&n.apply(e,{region:t})},_onStatableBeforeEmpty:function(t,e){var n=this.stateApi&&i.isFunction(this.stateApi.collect)?this.stateApi:void 0;n&&n.collect(e,{region:t})},setStateApi:function(t){this.stateApi=t,this._initStateApi()},removeView:function(t){"detach"===(this.getOption("removeBehavior")||"destroy")?this.detachView(t):this.destroyView(t)},getParentView:function(){return this._parentView}});gt.Detachable=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=i.extend({},t,{removeBehavior:"detach"});return this.extend(e)};var dt=O(e.View).with(J,P).extend({instantRender:!1,renderOnReady:!1,constructor:function(){this._fixRegionProperty();for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.View.apply(this,i);var r=i[0];this.mergeOptions(r,["instantRender","renderOnReady","triggerReady","manualAfterInitialize"]),!0===this.renderOnReady&&this.once("ready",this.render),!0!==this.instantRender||this.renderOnReady?!0===this.instantRender&&!0===this.renderOnReady&&this.triggerReady():this.render()},_fixRegionProperty:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getProperty("detachableRegion");null==e&&(e=!0===t.detachableRegion);var i=this.getProperty("stateApi");null==i&&(i=t.stateApi);var n=i?gt.extend({stateApi:i}):gt;this.regionClass=e?n.Detachable():n},triggerReady:function(){this.trigger("ready",this)},stateApi:function(){var t=this.getOption("stateApiOptions");return new A(t)},stateApiOptions:function(){var t=this;return{storeIdPrefix:function(){return t.getOption("id")},states:["scrollable"]}}}),ft=k.extend({initialize:function(t){this.mergeOptions(t,["name","channelName","noRadio"]),!0!==this.noRadio&&null==this.channelName&&(this.channelName=name)},getStore:function(){return this.store||(this.store={}),this.store},radioRequest:{get:function(){this.get.apply(this,arguments)},set:function(t,e){this.set(t,e)}},get:function(t){var e=f(this.getStore(),t);if(i.isFunction(e)){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];e=e.apply(this,r)}return e},set:function(t,e){var i=this.getStore();d(i,t,e);this.triggerSet(t,e)},triggerSet:function(t,e){if(t){var i=t.split("/"),n=this.getChannel();do{var r=i.join(":");this.triggerMethod(r,e),n&&n.trigger(r,e),i.pop()}while(i.length>0)}}});function pt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.name=t,new ft(e)}var vt=new pt("yat:modals:singleton",{noRadio:!0}),yt={bg:!0,close:!0},mt={closeOnClickOutside:!0,closeOnPromise:!0,preventClose:!1,asPromise:!1},_t={wrapper:"yat-modal-wrapper",bg:"yat-modal-bg",contentWrapper:"yat-modal-content-wrapper",close:"yat-modal-close",header:"yat-modal-header",content:"yat-modal-content",actions:"yat-modal-actions",resolve:"yat-modal-resolve",reject:"yat-modal-reject"},bt={close:"&times;",resolve:"ok",reject:"cancel"},wt={"after:render":{centering:function(){var t=this.$("[data-role=modal-content-wrapper]");if(t.length){var e=t.outerHeight(),i=(n(window).height()-e)/3;i>0&&t.length&&t.css({"margin-top":i+"px"})}}}},xt={full:{css:_t,show:yt,labels:bt,options:mt,modifiers:wt},simple:{css:_t,show:{bg:!1,close:!1},labels:bt,options:mt,modifiers:wt},confirm:{css:_t,show:yt,labels:bt,options:{closeOnClickOutside:!0,closeOnPromise:!0,preventClose:!1,asPromise:!0},modifiers:wt}};vt.set("types.full",xt.full),vt.set("types.simple",xt.simple),vt.set("types.confirm",xt.confirm),vt.set("defaultShow",yt),vt.set("defaultCss",_t),vt.set("defaultLabels",bt),vt.set("defaultModifiers",wt);var Ct=i.template("<% if(show.bg) {%><div <%= css('bg') %> data-role=\"modal-bg\"></div><% } %>\n<div <%= css('contentWrapper') %> data-role=\"modal-content-wrapper\">\n\t<% if(show.close) {%><button  <%= css('close') %> data-role=\"modal-close\"><%= label('close') %></button><% } %>\n\t<% if(show.header) {%><header <%= css('header') %> data-role=\"modal-header\"><%= header %></header><% } %>\n\t<div <%= css('content') %> data-role=\"modal-content\"><%= text %></div>\n\t<% if(show.actions) {%>\n\t<div <%= css('actions') %> data-role=\"modal-actions\">\n\t\t<% if(show.resolve) {%><button <%= css('resolve') %> data-role=\"modal-resolve\"><%= label('resolve') %></button><% } %>\n\t\t<% if(show.reject) {%><button <%= css('reject') %> data-role=\"modal-reject\"><%= label('reject') %></button><% } %>\n\t</div>\n\t<% } %>\n</div>\n"),Ot=O(dt).with(P).extend({instantRender:!0,renderOnReady:!0,template:Ct,attributes:function(){return{"data-role":"modal-wrapper"}},initialize:function(t){var e=this;this.mergeOptions(t,["content","header","text"]);var i=this;!0===this.getOption("asPromise")&&(this.promise=new Promise(function(t,e){i.once("resolve",function(e){return t(e)}),i.once("reject",function(t){return e(t)})})),this.once("resolve reject",function(t,i){e.preventClose=!1,e.getConfigValue("options","closeOnPromise")&&!i&&e.destroy()}),this.on("all",function(t){return e.applyModifiers(t)})},canBeClosed:function(){return!0!==this.getConfigValue("options","preventClose")},destroy:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.canBeClosed()||!0===t.force)return dt.prototype.destroy.apply(this,arguments)},ui:{bg:'[data-role="modal-bg"]',contentWrapper:'[data-role="modal-content-wrapper"]',text:'[data-role="modal-content"]',header:'[data-role="modal-header"]',close:'[data-role="modal-close"]',resolve:'[data-role="modal-resolve"]',reject:'[data-role="modal-reject"]'},triggers:{"click @ui.close":{event:"click:close",stopPropagation:!0},"click @ui.reject":{event:"click:reject",stopPropagation:!0},"click @ui.resolve":{event:"click:resolve",stopPropagation:!0},"click @ui.text":{event:"click:content",stopPropagation:!0},"click @ui.contentWrapper":{event:"click:content:wrapper",stopPropagation:!0},"click @ui.bg":{event:"click:bg",stopPropagation:!0},click:{event:"click:wrapper",stopPropagation:!0}},regions:{content:'[data-role="modal-content"]'},onBeforeDestroy:function(){this.trigger("reject",this.getProperty("reject"),!0)},onClickClose:function(){this.destroy()},onClickResolve:function(){this.trigger("resolve",this.getProperty("resolve"))},onClickReject:function(){this.trigger("reject",this.getProperty("reject"))},onClickBg:function(){this.clickedOutsideOfModal()},onClickWrapper:function(){this.clickedOutsideOfModal()},clickedOutsideOfModal:function(){!0===this.getConfigValue("options","closeOnClickOutside")&&this.destroy()},onBeforeRender:function(){var t=this.getConfig();t.css.wrapper&&this.$el.addClass(t.css.wrapper),this.$el.appendTo(n("body"))},onRender:function(){this.content instanceof t.View&&(this.content.inModal=this,this.showChildView("content",this.content)),this.applyModifiers("after:render")},_getModalOptions:function(){var t={};return null!=this.getOption("closeOnClickOutside")&&(t.closeOnClickOutside=this.getOption("closeOnClickOutside")),null!=this.getOption("closeOnPromise")&&(t.closeOnPromise=this.getOption("closeOnPromise")),null!=this.getOption("preventClose")&&(t.preventClose=this.getOption("preventClose")),null!=this.getOption("asPromise")&&(t.asPromise=this.getOption("asPromise")),t},getConfigValue:function(t,e){return((this.getConfig()||{})[t]||{})[e]},getConfig:function(t){if(this.config)return this.config;var e=this.getOption("type")||"simple",n=i.extend({},vt.get("types."+e)||{});return n.show=i.extend({},vt.get("dafaultShow"),n.show,this.getOption("show")),n.labels=i.extend({},vt.get("defaultLabels"),n.labels,this.getOption("labels")),n.css=i.extend({},vt.get("defaultCss"),n.css,this.getOption("css")),n.modifiers=i.extend({},vt.get("defaultModifiers"),n.modifiers,this.getOption("modifiers")),n.options=i.extend({},vt.get("defaultOptions"),n.options,this._getModalOptions()),null==n.show.header&&this.getOption("header")&&(n.show.header=!0),null==n.show.resolve&&(this.getOption("resolve")||n.options.asPromise)&&(n.show.resolve=!0),null==n.show.reject&&this.getOption("reject")&&(n.show.reject=!0),null==n.show.actions&&(n.show.resolve||n.show.reject)&&(n.show.actions=!0),this.config=n},applyModifiers:function(t){var e=this,n=this.getConfigValue("modifiers",t);i(n).each(function(t){return i.isFunction(t)&&t.call(e)})},templateContext:function(){var t=this.getConfig();return{css:function(e){return t.css[e]?' class="'+t.css[e]+'"':""},label:function(e){return t.labels[e]||""},show:t.show,text:this.getOption("text"),header:this.getOption("header")}}}),Pt=new(O(k).with(j).extend({constructor:function(){var t=this;this.modals=[];for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];k.apply(this,r),this.listenForEsc=i.bind(this._listenForEsc,this),n(function(){t.doc=n(document),t.doc.on("keyup",t.listenForEsc)})},channelName:"modals",show:function(){var t=this._normalizeArguments.apply(this,arguments);return this._create(t)},remove:function(t){t||(t=i.last(this.modals)),t&&t.destroy()},_listenForEsc:function(t){27===t.keyCode&&this.modals.length&&this.remove()},_create:function(t){var e=new Ot(t),i=this;return this.listenToOnce(e,"destroy",function(){i._remove(e)}),this.modals.push(e),e},_remove:function(t){if(t){var e=this.modals.indexOf(t);e>-1&&this.modals.splice(e,1),this.stopListening(t)}},_normalizeArguments:function(){var t={},e=arguments.length;if(e){if(1===e)_.isView(arguments.length<=0?void 0:arguments[0])?t.content=arguments.length<=0?void 0:arguments[0]:i.isString(arguments.length<=0?void 0:arguments[0])?t.text=arguments.length<=0?void 0:arguments[0]:i.isObject(arguments.length<=0?void 0:arguments[0])&&i.extend(t,arguments.length<=0?void 0:arguments[0]);else if(2===e)i.isString(arguments.length<=0?void 0:arguments[0])&&i.isString(arguments.length<=1?void 0:arguments[1])?(t.header=arguments.length<=0?void 0:arguments[0],t.text=arguments.length<=1?void 0:arguments[1]):i.isString(arguments.length<=0?void 0:arguments[0])&&_.isView(arguments.length<=1?void 0:arguments[1])?(t.header=arguments.length<=0?void 0:arguments[0],t.content=arguments.length<=1?void 0:arguments[1]):i.isString(arguments.length<=1?void 0:arguments[1])&&_.isView(arguments.length<=0?void 0:arguments[0])?(t.header=arguments.length<=1?void 0:arguments[1],t.content=arguments.length<=0?void 0:arguments[0]):i.isString(arguments.length<=0?void 0:arguments[0])&&i.isObject(arguments.length<=1?void 0:arguments[1])?(i.extend(t,arguments.length<=1?void 0:arguments[1]),_.isView(t.content)?t.header=arguments.length<=0?void 0:arguments[0]:t.text=arguments.length<=0?void 0:arguments[0]):_.isView(arguments.length<=0?void 0:arguments[0])&&i.isObject(arguments.length<=1?void 0:arguments[1])&&(i.extend(t,arguments.length<=1?void 0:arguments[1]),t.content=arguments.length<=0?void 0:arguments[0]);else{i.isObject(arguments.length<=3?void 0:arguments[3])&&i.extend(t,arguments.length<=3?void 0:arguments[3]),i.isObject(arguments.length<=2?void 0:arguments[2])?i.extend(t,arguments.length<=2?void 0:arguments[2]):i.isString(arguments.length<=2?void 0:arguments[2])&&(t.type=arguments.length<=2?void 0:arguments[2]);var n=this._normalizeArguments(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1]);i.extend(t,n)}return t}},onBeforeDestroy:function(){this.doc&&this.doc.off("keyup",this.listenForEsc)}})),St={show:function(){return Pt.show.apply(Pt,arguments)},addTypeConfig:function(t,e){t&&i.isString(t)&&vt.set("types."+t,e)},getTypeConfig:function(t){if(t&&i.isString(t))return vt.get("types."+t)}},kt={TemplateContext:Q,identity:ct,modals:St},Mt=O(e.Application).with(P,S,W,Y),Rt=Mt.extend({initRadioOnInitialize:!0,_initRegion:function(){if(!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{skip:!0}).skip){var t=this.getProperty("region");this.region=t,Mt.prototype._initRegion()}},getRegion:function(){return this._region||this._initRegion({skip:!1}),this._region},addPageManager:function(t){var e=this;this._pageManagers||(this._pageManagers=[]),this._pageManagers.push(t),this.triggerMethod("add:pageManager",t),this.listenTo(t,"page:start",function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];return e.triggerMethod.apply(e,["page:start",t].concat(n))})},hasPageManagers:function(){return this._pageManagers&&this._pageManagers.length>0},getLinksCollection:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{rebuild:!1};return this._menuTree&&!t.rebuild?this._menuTree:(this.createLinksCollection(),this._menuTree)},createLinksCollection:function(){var e=this._pageManagers||[],n=i(e).chain().map(function(t){return t.getLinks()}).flatten().value();this._menuTree?this._menuTree.set(n):this._menuTree=new t.Collection(n)},getCurrentPages:function(){var t=i(this._pageManagers).map(function(t){return t.getCurrentPage()});return i(t).filter(function(t){return null!=t})},isCurrentPage:function(t){return this.getCurrentPages().indexOf(t)>-1},getPage:function(t){if(this.hasPageManagers())return i(this._pageManagers).find(function(e){return e.getPage(t)})}}),At=t.Model.extend({});At.extend({defaults:{url:void 0,label:void 0,target:"_self",level:0},destroy:function(){this.id=null,At.prototype.destroy.apply(this,arguments)}});function Dt(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}var Et={hasLink:function(){return!this.getProperty("skipMenu")&&!this.getProperty("preventStart")},getLink:function(t,e){if(this.hasLink()){if(this._linkHash)return this._linkHash;var i=(this.getParentLink()||{}).id,n=this.getRoute(),r=this.getLabel();return this._linkHash={id:this.cid,parentId:i,url:n,label:r,level:t,index:e},this._linkHash}},getParentLink:function(){var t=this.getParent();return t&&t.getLink&&t.getLink()},getLinks:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.getLink(t,e);if(!i)return[];var n=this._getSubLinks(t);return[i].concat(n)},_getSubLinks:function(t){var e=this.getChildren();if(!e||!e.length)return[];var n=i(e).filter(function(t){return t.hasLink()});return n=i(n).map(function(e,i){return e.getLinks(t+1,i)}),i.flatten(n)}},jt={getLayout:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{rebuild:!1};return(!this._layoutView||t.rebuild||this._layoutView&&this._layoutView.isDestroyed&&this._layoutView.isDestroyed())&&this.buildLayout(),this._layoutView},buildLayout:function(){var t=this.getProperty("Layout");if(null!=t){var e=i.extend({},this.getProperty("layoutOptions"));this.model&&!e.model&&i.extend(e,{model:this.model}),this.collection&&!e.collection&&i.extend(e,{collection:this.collection});var n=this.buildLayoutOptions(e);return n.page=this,this._layoutView=new t(n),this._layoutView}},buildLayoutOptions:function(t){return t}},Tt={getRouteHash:function(){var t=[{},this._routeHandler].concat(this.getChildren({startable:!1}).map(function(t){return t.getRouteHash()}));return i.extend.apply(i,Dt(t))},hasRouteHash:function(){return i.isObject(this.getRouteHash())},_initializeRoute:function(){var t=this.getRoute({asPattern:!0});if(null!=t){var e=this;this._routeHandler=(i={},n=t,r={context:e,action:function(){return e.start.apply(e,arguments)}},n in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i);var i,n,r}},getRoute:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{asPattern:!1},e=this.getProperty("relativeRoute"),i=this.getProperty("route"),n=this.getParent();if(null!=i){var r=i;if(e&&n&&n.getRoute){r=n.getRoute()+"/"+i}return this._normalizeRoute(r,t)}},_normalizeRoute:function(t,e){if(t=t.replace(/\/+/gim,"/").replace(/^\//,""),e.asPattern)return t;return t.replace(/\(\/\)/gim,"/").replace(/\/+/gim,"/")},url:function(){return this.getRoute()}},Vt={addModel:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t){this.model=t;var i=e.fetch||this.getOption("fetchModelOnAdd");void 0===i&&(i=this.getProperty("fetchDataOnAdd")),!0===i&&this.addStartPromise(t.fetch(e))}},addCollection:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t){this.collection=t;var i=e.fetch||this.getOption("fetchCollectionOnAdd");void 0===i&&(i=this.getProperty("fetchDataOnAdd")),!0===i&&this.addStartPromise(t.fetch(e))}},_initializeLayoutModels:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.addModel(t.model,t),this.addCollection(t.collection,t)}},zt={_proxyEvents:function(){var t=this._getProxyContexts();this._proxyEventsTo(t)},_getProxyContexts:function(){var t=[],e=this.getProperty("manager");if(e){var i=this.getProperty("proxyEventsToManager");t.push({context:e,allowed:i})}var n=this.getChannel();if(n){var r=this.getProperty("proxyEventsToRadio");t.push({context:n,allowed:r})}return t},_proxyEventsTo:function(t){var e=[],n={};i(t).each(function(t){t.allowed?i(t.allowed).each(function(e){n[e]||(n[e]=[]),n[e].push(t.context)}):e.push(t.context)});var r=this;r.on("all",function(t){for(var o=arguments.length,s=Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];var l=t in n?n[t]:e,h=[r].concat(s);i(l).each(function(e){return e.triggerMethod.apply(e,["page:"+t].concat(Dt(h)))})})}},Ht=O(Rt).with(E,Et,jt,Vt,zt,Tt),Ft=Ht.extend({constructor:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];Ht.apply(this,e),this.initializeYatPage()},freezeWhileStarting:!0,allowStopWithoutStart:!0,allowStartWithoutStop:!0,proxyEventsToManager:function(){return["before:start","start","start:decline","before:stop","stop","stop:decline"]},initializeYatPage:function(t){this.mergeOptions(t,["manager"]),this._initializeLayoutModels(t),this._initializeRoute(t),this._proxyEvents()},_buildChildOptions:function(t){var e={},n=this.getProperty("manager");return n&&(e.manager=n),i.extend(t,this.getProperty("childOptions"),e)},getRoot:function(){var t=this.getParent();return t instanceof Ht?t.getRoot():this}}),Bt={routerClass:e.AppRouter,createRouter:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getRouterOptions(),i=new(this.getProperty("routerClass"))(e);return!0!==t.doNotSet&&this.setRouter(i),i},_createRoutesHash:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._routesHash&&!0!==t.rebuild)return this._routesHash;var e=this.getChildren({startable:!1}),n={};return i(e).each(function(t){i.isFunction(t.getRouteHash)&&i.extend(n,t.getRouteHash())}),this._routesHash=n,n},getRouterOptions:function(){var t=this;hash=this._createRoutesHash();var e={},n={};return i(hash).each(function(i,r){e[r]=r,n[r]=t.createRouterControllerAction(i,r)}),{appRoutes:e,controller:n}},createRouterControllerAction:function(t,e){var i=this,n=t.context;return function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];i.startPage.apply(i,[n].concat(e))}},setRouter:function(t){this.router&&i.isFunction(this.router.destroy)&&this.router.destroy(),this.router=t},getRouter:function(){return this.router},execute:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{silent:!0},i=this.getPage(t);if(!i)throw new C.NotFound("Route not found");i.start(e)},navigate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{trigger:!0},i=this.getRouter();i?i.navigate(t,e):console.warn("router not found")},navigateToRoot:function(){var t=this.getState("currentPage");if(!t)throw new C({message:"navigateToRoot: root not found"});this.navigate(t.getRoot().url())}},Lt={_registerIdentityHandlers:function(){this.listenTo(ct,"change",this._restartOrGoToRoot),this.listenTo(ct,"token:expired",this.tokenExpired)},_restartOrGoToRoot:function(){this.routedPage&&(this.routedPage.getProperty("preventStart")?this.navigateToRoot():this.restartRoutedPage())},tokenExpired:function(){this.restartRoutedPage()}},Nt=O(Rt).with(E,Bt,Lt),Gt=Nt.extend({constructor:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];Nt.apply(this,e),this._initializeYatPageManager.apply(this,e)},_initializeYatPageManager:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.mergeOptions(t,["id","name","label"]),this._registerPageHandlers(t),this._registerIdentityHandlers(),this.createRouter()},throwChildErrors:!0,startPage:function(t){var e=this;this.previousRoutedPage=this.routedPage,this.routedPage=t;for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return t.start.apply(t,n).catch(function(i){if(!0===e.getProperty("throwChildErrors"))throw i;var n="error"+(i.status?":"+i.status.toString():"");e.triggerMethod("error",i,t),"error"!=n&&e.triggerMethod(n,i,t)})},restartRoutedPage:function(){this.routedPage&&this.startPage(this.routedPage)},getLinks:function(){var t=this.getChildren();return t?i(t).chain().map(function(t){return t.getLinks()}).filter(function(t){return!!t}).flatten().value():[]},getPage:function(t){var e=i(this._routesHash).find(function(e,i){return i===t||(e.context.getName()===t||void 0)});return e&&e.context},getCurrentPage:function(){return this.getState("currentPage")},isCurrentPage:function(t){return t===this.getCurrentPage()},_buildChildOptions:function(t){return i.extend(t,this.getProperty("childOptions"),{manager:this})},_registerPageHandlers:function(){this.on("page:before:start",this._pageBeforeStart),this.on("page:start",this._pageStart),this.on("page:start:decline",this._pageDecline)},_pageBeforeStart:function(t){var e=this.getState("currentPage");e&&e!=t&&e.stop()},_pageStart:function(t){this.setState("currentPage",t)},_pageDecline:function(){}}),$t=O(e.NextCollectionView).with(J),It=t.Collection.extend({}),Ut=k.extend({collection:void 0,groupBy:void 0,getGroups:function(){return this.groups},getGroup:function(t){return this.getGroups()[t]},isGroupExists:function(t){return t in this.getGroups()},addGroup:function(t,e){if(!this.isGroupExists(t)){var i=this.getGroups();return i[t]=this._createGroup(t,e),i[t]}},removeGroup:function(t){var e=this.getGroup(t);e&&(i.isFunction(e.destroy)?e.destroy():i.isFunction(e.stopListening)&&e.stopListening(),delete this.groups[t])},group:function(){var t={},e=this.collection.groupBy(this.groupBy),n=this.getOption("groups");return i(n).each(function(i){i in e?(t[i]=e[i],delete e[i]):t[i]=[]}),i(e).each(function(e,i){return t[i]=e}),t},constructor:function(t){k.apply(this,arguments),this._initializeGrouppedCollection(t)},_initializeGrouppedCollection:function(t){1!=this._initializedGC&&(this.mergeOptions(t,["collection","groupBy"]),this._ensureOptions(),this._initializeGroups(),this._initializeEventHandlers(),this._initializedGC)},_ensureOptions:function(){if(!this.collection)throw new Error("collection must be set");if(!this.groupBy)throw new Error("groupBy must be set");if("string"==typeof this.groupBy){var t=this.getOption("groupBy");this.groupBy=function(e){return e.get(t)}}},_initializeGroups:function(){var t=this;this.groups={};var e=this.group();i(e).each(function(e,i){return t.addGroup(i,e)})},_getCollectionClass:function(){return this.getOption("CollectionClass")||It},_createGroup:function(t,e){var i=this.groupBy,n=new(this._getCollectionClass())(e);return n.on("change",function(e){i(e)!==t&&n.remove(e)}),n.name=t,n},_initializeEventHandlers:function(){this.listenTo(this.collection,"update",this._onCollectionUpdate)},_onCollectionUpdate:function(t,e){var n=this,r=(e.changes.added||[]).concat(e.changes.merged||[]),o=i(r).groupBy(this.groupBy),s=i(e.changes.removed).groupBy(this.groupBy),a=this.groups;i(o).each(function(t,e){e in a?a[e].add(t):n.getOption("autoCreateNewGroups")&&n.addGroup(e,t)}),i(s).each(function(t,e){e in a&&a[e].remove(t)})},_onModelChange:function(t){var e=this.groupBy(t);this.groups[e]?this.groups[e].add(t):console.warn("model is out of groupping",t,e)},destroy:function(){i(this.groups).each(function(t){t.stopListening(),i.isFunction(t.destroy)&&t.destroy()}),delete this.groups,i.isFunction(k.prototype.destroy)&&k.prototype.destroy.apply(this,arguments),i.isFunction(this.collection.destroy)&&this.collection.destroy(),delete this.collection}});return{VERSION:"0.0.32",Functions:b,Helpers:D,Mixins:Z,Behaviors:lt,Singletons:kt,TemplateContext:Q,modals:St,identity:ct,createConfig:pt,Object:k,Error:C,App:Rt,Page:Ft,PageManager:Gt,View:dt,CollectionView:$t,Region:gt,Model:At,Collection:It,CollectionGroups:Ut}}),this&&this.Marionette&&(this.Marionette.Yat=this.MarionetteYat);
//# sourceMappingURL=marionette.yat.min.js.map